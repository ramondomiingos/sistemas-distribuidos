# DocumentaÃ§Ã£o AcadÃªmica - Parte 3: Fluxogramas e Diagramas

## 8. Fluxogramas e Diagramas

### 8.1 Diagrama de Arquitetura Geral

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CAMADA DE APRESENTAÃ‡ÃƒO                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  API REST Client (Postman, Frontend, CLI)                        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ HTTP POST /api/v1/privacy-requests/
                              â”‚ {"account_id": "123", "request_type": "DELETE"}
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMADA DE ORQUESTRAÃ‡ÃƒO                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    MIDDLEWARE SERVICE (Port 8000)                   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  FastAPI Application                                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - POST /api/v1/privacy-requests/                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - GET  /api/v1/privacy-requests/                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - GET  /api/v1/privacy-requests/{id}                        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                         â”‚                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Privacy Request Service                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Persiste requisiÃ§Ãµes                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Gerencia status e timestamps                              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                         â”‚                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Kafka Controller (Two-Phase Commit Orchestrator)            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - publish_validate_request()                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - collect_validation_responses()                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - decide_commit_or_abort()                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - publish_execute_request()                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - collect_execution_responses()                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - update_final_status()                                     â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                         â”‚                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  PostgreSQL Database (middleware_db)                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  Tables:                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - services                                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - privacy_requests                                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - privacy_request_services                                  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚               â”‚
                   Fase 1    â”‚               â”‚    Fase 2
                  (Validate) â”‚               â”‚   (Execute)
                             â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMADA DE MENSAGERIA                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    APACHE KAFKA (Port 9092)                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Topics:                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  1. privacy-validate-topic          (1 partition)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  2. privacy-validate-response-topic (1 partition)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  3. privacy-execute-topic           (1 partition)           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  4. privacy-execute-response-topic  (1 partition)           â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Zookeeper (Coordination)                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Consumer group management                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Offset tracking                                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Leader election                                           â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚            â”‚            â”‚            â”‚
             â–¼            â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CAMADA DE MICROSSERVIÃ‡OS                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ACCOUNTS   â”‚  â”‚   PAYMENTS   â”‚  â”‚     CRM      â”‚  â”‚   DELIVERY   â”‚  â”‚
â”‚  â”‚  (Port 5001) â”‚  â”‚  (Port 5002) â”‚  â”‚  (Port 5003) â”‚  â”‚  (Port 5004) â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ FastAPI  â”‚ â”‚  â”‚ â”‚ FastAPI  â”‚ â”‚  â”‚ â”‚ FastAPI  â”‚ â”‚  â”‚ â”‚ FastAPI  â”‚ â”‚  â”‚
â”‚  â”‚ â”‚   App    â”‚ â”‚  â”‚ â”‚   App    â”‚ â”‚  â”‚ â”‚   App    â”‚ â”‚  â”‚ â”‚   App    â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ validate â”‚ â”‚  â”‚ â”‚ validate â”‚ â”‚  â”‚ â”‚ validate â”‚ â”‚  â”‚ â”‚ validate â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ execute  â”‚ â”‚  â”‚ â”‚ execute  â”‚ â”‚  â”‚ â”‚ execute  â”‚ â”‚  â”‚ â”‚ execute  â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚ â”‚ handler  â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚  Kafka   â”‚ â”‚  â”‚ â”‚  Kafka   â”‚ â”‚  â”‚ â”‚  Kafka   â”‚ â”‚  â”‚ â”‚  Kafka   â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ Consumer â”‚ â”‚  â”‚ â”‚ Consumer â”‚ â”‚  â”‚ â”‚ Consumer â”‚ â”‚  â”‚ â”‚ Consumer â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ Wrapper  â”‚ â”‚  â”‚ â”‚ Wrapper  â”‚ â”‚  â”‚ â”‚ Wrapper  â”‚ â”‚  â”‚ â”‚ Wrapper  â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚      â”‚       â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚   User   â”‚ â”‚  â”‚ â”‚  Order   â”‚ â”‚  â”‚ â”‚ UserInfo â”‚ â”‚  â”‚ â”‚ Delivery â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  Table   â”‚ â”‚  â”‚ â”‚  Table   â”‚ â”‚  â”‚ â”‚  Table   â”‚ â”‚  â”‚ â”‚  Table   â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚ PostgreSQL   â”‚  â”‚ PostgreSQL   â”‚  â”‚ PostgreSQL   â”‚  â”‚ PostgreSQL   â”‚  â”‚
â”‚  â”‚ (Port 5433)  â”‚  â”‚ (Port 5434)  â”‚  â”‚ (Port 5435)  â”‚  â”‚ (Port 5436)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CAMADA DE OBSERVABILIDADE                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Grafana LGTM Stack (Port 3000)                                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚
â”‚  â”‚  â”‚   Loki       â”‚  â”‚   Grafana    â”‚  â”‚    Tempo     â”‚             â”‚  â”‚
â”‚  â”‚  â”‚   (Logs)     â”‚  â”‚ (Dashboard)  â”‚  â”‚   (Traces)   â”‚             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚  â”‚
â”‚  â”‚  â”‚    Mimir     â”‚  â”‚  Prometheus  â”‚                               â”‚  â”‚
â”‚  â”‚  â”‚  (Metrics)   â”‚  â”‚  (Metrics)   â”‚                               â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â–²                                           â”‚
â”‚                                â”‚ OpenTelemetry (OTLP gRPC Port 4317)       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚         â”‚ All services send: Traces, Metrics, Logs        â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 8.2 Diagrama de SequÃªncia - Fluxo Completo (Caso de Sucesso)

```
Cliente    Middleware         Kafka        Accounts    Payments      CRM      Delivery
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚POST        â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚/privacy-   â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚requests/   â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚1. Persiste     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   (PENDING)    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚      â”‚         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 201 Created    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚  {id: 1,   â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚   status:  â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚   PENDING} â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚2. Publish      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   validate     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ privacy-       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ validate-topic â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚3. Broadcast â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚     4. Valida regras de negÃ³cio               â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”
  â”‚            â”‚                â”‚             â”‚  âœ“  â”‚     â”‚  âœ“  â”‚     â”‚  âœ“  â”‚     â”‚  âœ“  â”‚
  â”‚            â”‚                â”‚             â”‚Pode â”‚     â”‚Sem  â”‚     â”‚Pode â”‚     â”‚Sem  â”‚
  â”‚            â”‚                â”‚             â”‚Del  â”‚     â”‚Pend â”‚     â”‚Del  â”‚     â”‚Entr â”‚
  â”‚            â”‚                â”‚             â”‚     â”‚     â”‚     â”‚     â”‚     â”‚     â”‚TrÃ¢nsâ”‚
  â”‚            â”‚                â”‚             â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚5. Publica respostas                            â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚            â”‚                â”‚ privacy-validate-response-topic             â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚6. Consome      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   respostas    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚7. Consolida    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   (4/4 OK)     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ DECISÃƒO:       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ COMMIT         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚8. Atualiza     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   (VALIDATING) â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚      â”‚         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚9. Publish      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   execute      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ privacy-       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ execute-topic  â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚10. Broadcastâ”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚     11. Executa deleÃ§Ã£o (transaÃ§Ã£o atÃ´mica)    â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”
  â”‚            â”‚                â”‚             â”‚DEL  â”‚     â”‚DEL  â”‚     â”‚DEL  â”‚     â”‚DEL  â”‚
  â”‚            â”‚                â”‚             â”‚User â”‚     â”‚5 Ordâ”‚     â”‚1 Infâ”‚     â”‚3 Delâ”‚
  â”‚            â”‚                â”‚             â”‚COMMIT     â”‚COMMIT     â”‚COMMIT     â”‚COMMIT
  â”‚            â”‚                â”‚             â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚12. Publica confirmaÃ§Ãµes                        â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚            â”‚                â”‚ privacy-execute-response-topic              â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚13. Consome     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚    confirmaÃ§Ãµesâ”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚14. Consolida   â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚    (4/4 OK)    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚DECISÃƒO:        â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚COMPLETED       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚15. Atualiza    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚    status      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚    (COMPLETED) â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚      â”‚         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
```

---

### 8.3 Diagrama de SequÃªncia - Caso de RejeiÃ§Ã£o (ValidaÃ§Ã£o)

```
Cliente    Middleware         Kafka        Accounts    Payments      CRM      Delivery
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚POST        â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚/privacy-   â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚requests/   â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚1. Persiste     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   (PENDING)    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚      â”‚         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 201 Created    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚2. Publish      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   validate     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚3. Broadcast â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚           â”‚
  â”‚            â”‚                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚     4. Valida regras de negÃ³cio               â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”     â”œâ”€â”€â”€â”€â”€â”
  â”‚            â”‚                â”‚             â”‚  âœ“  â”‚     â”‚  âœ—  â”‚     â”‚  âœ“  â”‚     â”‚  âœ“  â”‚
  â”‚            â”‚                â”‚             â”‚Pode â”‚     â”‚2 Pagâ”‚     â”‚Pode â”‚     â”‚Sem  â”‚
  â”‚            â”‚                â”‚             â”‚Del  â”‚     â”‚Pend â”‚     â”‚Del  â”‚     â”‚Entr â”‚
  â”‚            â”‚                â”‚             â”‚     â”‚     â”‚âŒ   â”‚     â”‚     â”‚     â”‚TrÃ¢nsâ”‚
  â”‚            â”‚                â”‚             â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜     â”‚<â”€â”€â”€â”€â”˜
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚5. Publica respostas                            â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚   result:   â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚   true      â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚           â”‚
  â”‚            â”‚                â”‚   result: false        â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚   (2 payments pending) â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
  â”‚            â”‚                â”‚   result: true         â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚            â”‚                â”‚   result: true         â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚6. Consome      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   respostas    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚7. Consolida    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   (3/4 OK,     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚    1/4 REJEIT) â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ DECISÃƒO:       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ âŒ ABORT       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚8. Atualiza     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   status:      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   FAILED       â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   reason:      â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   "Payments    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   bloqueou"    â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”œâ”€â”€â”€â”€â”€â”€â”         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚      â”‚         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚<â”€â”€â”€â”€â”€â”˜         â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚ğŸ›‘ PROCESSO     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚  ENCERRADO     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚  (nÃ£o publica  â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚   execute)     â”‚             â”‚           â”‚           â”‚           â”‚
  â”‚            â”‚                â”‚             â”‚           â”‚           â”‚           â”‚
```

---

### 8.4 Fluxograma - LÃ³gica do Middleware (OrquestraÃ§Ã£o)

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Recebe POST Request    â”‚
                        â”‚  /api/v1/privacy-       â”‚
                        â”‚  requests/              â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  Valida Payload         â”‚
                        â”‚  (account_id,           â”‚
                        â”‚   request_type)         â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  VÃ¡lido?        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ NÃ£o                     Sim â”‚
                      â–¼                             â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Retorna 400/422    â”‚      â”‚ 1. Persiste no DB        â”‚
         â”‚ Bad Request        â”‚      â”‚    status: PENDING       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ 2. Retorna 201 Created   â”‚
                                     â”‚ 3. Inicia Async Task     â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚ FASE 1: VALIDAÃ‡ÃƒO        â”‚
                                     â”‚                          â”‚
                                     â”‚ Publica mensagem em:     â”‚
                                     â”‚ privacy-validate-topic   â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚ Aguarda respostas        â”‚
                                     â”‚ (timeout: 30s)           â”‚
                                     â”‚                          â”‚
                                     â”‚ Espera por N serviÃ§os    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                                  â–¼
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚ Recebe respostas via:    â”‚
                                     â”‚ privacy-validate-        â”‚
                                     â”‚ response-topic           â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚ Todas as respostasâ”‚
                                        â”‚ tÃªm result=true?  â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ NÃ£o (ABORT)                           Sim (COMMIT)
                          â–¼                                               â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Atualiza status:       â”‚                   â”‚ Atualiza status:         â”‚
              â”‚ FAILED                 â”‚                   â”‚ VALIDATING               â”‚
              â”‚                        â”‚                   â”‚                          â”‚
              â”‚ Registra serviÃ§o       â”‚                   â”‚ Registra aprovaÃ§Ãµes      â”‚
              â”‚ que bloqueou           â”‚                   â”‚ de todos os serviÃ§os     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                                            â”‚
                           â–¼                                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ ğŸ›‘ FIM                 â”‚                   â”‚ FASE 2: EXECUÃ‡ÃƒO         â”‚
              â”‚    (nÃ£o executa)       â”‚                   â”‚                          â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚ Publica mensagem em:     â”‚
                                                           â”‚ privacy-execute-topic    â”‚
                                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                        â”‚
                                                                        â–¼
                                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                           â”‚ Aguarda confirmaÃ§Ãµes     â”‚
                                                           â”‚ (timeout: 60s)           â”‚
                                                           â”‚                          â”‚
                                                           â”‚ Espera por N serviÃ§os    â”‚
                                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                        â”‚
                                                                        â–¼
                                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                           â”‚ Recebe confirmaÃ§Ãµes via: â”‚
                                                           â”‚ privacy-execute-         â”‚
                                                           â”‚ response-topic           â”‚
                                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                        â”‚
                                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                              â”‚ Todas as execuÃ§Ãµesâ”‚
                                                              â”‚ tÃªm result=true?  â”‚
                                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                        â”‚
                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                              â”‚ NÃ£o                                    Sim â”‚
                                              â–¼                                            â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Atualiza status:       â”‚             â”‚ Atualiza status:         â”‚
                                 â”‚ PARTIALLY_COMPLETED    â”‚             â”‚ COMPLETED                â”‚
                                 â”‚   ou FAILED            â”‚             â”‚                          â”‚
                                 â”‚                        â”‚             â”‚ Registra timestamp       â”‚
                                 â”‚ Registra quais serviÃ§osâ”‚             â”‚ de conclusÃ£o             â”‚
                                 â”‚ falharam               â”‚             â”‚                          â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚                                      â”‚
                                              â–¼                                      â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ âš ï¸ Requer intervenÃ§Ã£o  â”‚             â”‚ âœ… Processo ConcluÃ­do    â”‚
                                 â”‚    manual              â”‚             â”‚                          â”‚
                                 â”‚                        â”‚             â”‚ Dados deletados de todos â”‚
                                 â”‚ Rollback/compensaÃ§Ã£o   â”‚             â”‚ os microsserviÃ§os        â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 8.5 Fluxograma - LÃ³gica do MicrosserviÃ§o (Handler)

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ Kafka Consumer recebe   â”‚
                        â”‚ mensagem do tÃ³pico      â”‚
                        â”‚ privacy-validate-topic  â”‚
                        â”‚   ou                    â”‚
                        â”‚ privacy-execute-topic   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ Tipo de mensagem?   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ VALIDATE                       EXECUTEâ”‚
                 â–¼                                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Executa                â”‚           â”‚ Executa                  â”‚
    â”‚ validate_handler()     â”‚           â”‚ execute_handler()        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                    â”‚
                 â–¼                                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 1. Busca dados do      â”‚           â”‚ 1. Inicia transaÃ§Ã£o DB   â”‚
    â”‚    account_id no DB    â”‚           â”‚                          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                    â”‚
                 â–¼                                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ 2. Verifica regras de  â”‚           â”‚ 2. Busca registros do    â”‚
    â”‚    negÃ³cio do serviÃ§o  â”‚           â”‚    account_id            â”‚
    â”‚                        â”‚           â”‚                          â”‚
    â”‚ Exemplos:              â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ - Payments: status OK? â”‚                        â”‚
    â”‚ - Delivery: em trÃ¢nsito?â”‚                       â–¼
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                        â”‚ 3. DELETE registros      â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚                          â”‚
       â”‚ Pode deletar?     â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
                 â”‚                                     â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ NÃƒO              SIM â”‚            â”‚ 4. COMMIT transaÃ§Ã£o      â”‚
      â–¼                      â–¼            â”‚                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ result: falseâ”‚  â”‚ result: true     â”‚                â”‚
â”‚              â”‚  â”‚                  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ reason:      â”‚  â”‚ reason:          â”‚      â”‚ Sucesso?          â”‚
â”‚ "Bloqueado   â”‚  â”‚ "Pode deletar"   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  por X"      â”‚  â”‚                  â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                   â”‚                â”‚ NÃƒO              SIM â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â–¼                      â–¼
                   â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â–¼           â”‚ ROLLBACK         â”‚  â”‚ result: true         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                  â”‚  â”‚                      â”‚
    â”‚ 3. Publica resposta  â”‚  â”‚ result: false    â”‚  â”‚ reason:              â”‚
    â”‚    em:               â”‚  â”‚                  â”‚  â”‚ "N registros         â”‚
    â”‚ privacy-validate-    â”‚  â”‚ reason: "Erro DB"â”‚  â”‚  deletados"          â”‚
    â”‚ response-topic       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚                     â”‚
               â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                                  â”‚
               â”‚                                  â–¼
               â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                     â”‚ Publica resposta em:     â”‚
               â”‚                     â”‚ privacy-execute-         â”‚
               â”‚                     â”‚ response-topic           â”‚
               â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                                  â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ âœ… Handler completo â”‚
                    â”‚                     â”‚
                    â”‚ Consumer aguarda    â”‚
                    â”‚ prÃ³xima mensagem    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*[Continua na Parte 4 com ImplementaÃ§Ã£o Detalhada, Casos de Uso e README AcadÃªmico...]*
